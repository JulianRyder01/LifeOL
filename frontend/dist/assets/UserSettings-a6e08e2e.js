import{s as I,d as k,e as E,f as T,h as A,i as h,k as _,l as D,m as O,n as R,o as U,I as J,p as F,q as P,t as L,u as M,v as $,w as V,r as d,j as e,x as q}from"./index-7bec8ce1.js";function z(){return{version:_.DATA_FORMAT_VERSION,exportDate:new Date().toISOString(),attributes:D()||O(),events:R()||[],achievements:U()||J,items:F()||P(),projectEvents:L()||M(),selectedTitles:JSON.parse(localStorage.getItem("lifeol_selected_titles")||"[]"),userConfig:$()||V()}}function G(){try{const s=z(),r=JSON.stringify(s,null,2),l="data:application/json;charset=utf-8,"+encodeURIComponent(r),c=`lifeol-export-${new Date().toISOString().slice(0,10)}.json`,a=document.createElement("a");a.setAttribute("href",l),a.setAttribute("download",c),a.click()}catch(s){throw console.error("导出数据时出错:",s),s}}function H(s,r){const l=new FileReader;l.onload=c=>{var a;try{const o=JSON.parse((a=c.target)==null?void 0:a.result);W(o),r(!0)}catch(o){console.error("导入数据时出错:",o),r(!1)}},l.readAsText(s)}function W(s){try{I(s.attributes),k(s.events),E(s.achievements),T(s.items),A(s.projectEvents),s.selectedTitles&&localStorage.setItem("lifeol_selected_titles",JSON.stringify(s.selectedTitles)),s.userConfig&&h(s.userConfig)}catch(r){throw console.error("导入数据时出错:",r),r}}function K({userConfig:s,onUserConfigChange:r,onBack:l}){const[c,a]=d.useState(s.username),[o,b]=d.useState(s.avatar),[x,g]=d.useState(!1),[p,f]=d.useState(!1),[u,n]=d.useState({type:null,message:""});d.useEffect(()=>{const t=localStorage.getItem("lifeol_user_config");if(t){const i=JSON.parse(t);g(i.dontShowTaskCompleteConfirm||!1)}},[]);const y=()=>{const t={username:c,avatar:o};h(t),r(t);const i=localStorage.getItem("lifeol_user_config"),m=i?JSON.parse(i):{};m.dontShowTaskCompleteConfirm=x,localStorage.setItem("lifeol_user_config",JSON.stringify(m)),l()},j=()=>{f(!0)},v=()=>{q()},N=()=>{f(!1)},w=()=>{try{G(),n({type:"success",message:"数据导出成功！"}),setTimeout(()=>n({type:null,message:""}),3e3)}catch{n({type:"error",message:"数据导出失败，请重试。"}),setTimeout(()=>n({type:null,message:""}),3e3)}},C=t=>{var m;const i=(m=t.target.files)==null?void 0:m[0];i&&(H(i,S=>{S?(n({type:"success",message:"数据导入成功！页面将自动刷新。"}),setTimeout(()=>{n({type:null,message:""}),window.location.reload()},2e3)):(n({type:"error",message:"数据导入失败，请检查文件格式。"}),setTimeout(()=>n({type:null,message:""}),3e3))}),t.target.value="")};return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"用户设置"}),e.jsx("button",{onClick:l,className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.type&&e.jsx("div",{className:`mb-4 p-3 rounded ${u.type==="success"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:u.message}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"基本信息"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"用户名"}),e.jsx("input",{type:"text",value:c,onChange:t=>a(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"头像"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"text-4xl",children:o}),e.jsx("input",{type:"text",value:o,onChange:t=>b(t.target.value),placeholder:"输入emoji或字符",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]})]})]}),e.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"系统设置"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"任务完成确认提示"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"进度达到100%时是否显示确认提示"})]}),e.jsx("button",{onClick:()=>g(!x),className:`relative inline-flex h-6 w-11 items-center rounded-full ${x?"bg-blue-600":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${x?"translate-x-6":"translate-x-1"}`})})]})})]}),e.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"数据管理"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsx("button",{onClick:w,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"导出数据"}),e.jsxs("label",{className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus-within:ring-2 focus-within:ring-green-500 focus-within:ring-offset-2 text-center cursor-pointer",children:["导入数据",e.jsx("input",{type:"file",accept:".json",onChange:C,className:"hidden"})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"导出数据将保存您所有的属性、事件、成就、道具等信息。导入数据将替换当前所有数据，请谨慎操作。"})]})]}),e.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"关于"}),e.jsx("div",{className:"space-y-4",children:e.jsx("button",{onClick:()=>{},className:"w-full text-left px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"关于开发者"})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"危险操作"}),e.jsx("div",{className:"space-y-4",children:e.jsx("button",{onClick:j,className:"w-full text-left px-4 py-2 text-sm text-red-600 bg-red-50 rounded-md hover:bg-red-100",children:"重开人生"})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:y,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"保存设置"})})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/3 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"确认重开人生"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"确定要重开人生吗？此操作将清除所有数据，包括属性、事件、成就、道具等。"}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:N,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50",children:"取消"}),e.jsx("button",{onClick:v,className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700",children:"确认重开"})]})]})})})]})})}export{K as default};
