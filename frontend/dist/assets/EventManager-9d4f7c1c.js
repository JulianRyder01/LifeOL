import{r as m,j as e}from"./index-c5f90abf.js";const j={int:{name:"智力",icon:"book-open",color:"var(--int-color)"},str:{name:"体魄",icon:"dumbbell",color:"var(--str-color)"},vit:{name:"精力",icon:"battery",color:"var(--vit-color)"},cha:{name:"社交",icon:"users",color:"var(--cha-color)"},eq:{name:"情感",icon:"heart",color:"var(--eq-color)"},cre:{name:"创造",icon:"palette",color:"var(--cre-color)"}};function B({events:f,onDeleteEvent:y,onUpdateEvent:N,attributeNames:v={}}){const[w,p]=m.useState(null),[i,d]=m.useState({id:null,title:"",description:"",expGains:{}}),[k,C]=m.useState({}),[E,M]=m.useState({}),I={...j,...v},$=t=>{const s=I[t];return typeof s=="string"?s:(s==null?void 0:s.name)||t},c=f.reduce((t,s)=>{const l=new Date(s.timestamp),o=l.getFullYear(),a=l.getMonth();return t[o]||(t[o]={}),t[o][a]||(t[o][a]=[]),t[o][a].push(s),t},{}),L=t=>{p(t.id),d({id:t.id,title:t.title,description:t.description||"",expGains:t.expGains||{}})},g=()=>{p(null),d({id:null,title:"",description:"",expGains:{}})},D=()=>{i.id&&(N(i.id,{title:i.title,description:i.description}),g())},G=t=>{const s=new Date(t);return`${s.getMonth()+1}/${s.getDate()}`},Y=t=>{C(s=>({...s,[t]:!s[t]}))},O=t=>{M(s=>({...s,[t]:!s[t]}))},S=t=>["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"][t];return e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"人生时间轴"}),Object.keys(c).length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"暂无事件"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"开始记录你的人生事件吧"})]}):e.jsx("div",{children:Object.keys(c).sort((t,s)=>parseInt(s)-parseInt(t)).map(t=>{const s=parseInt(t),l=k[s]??!0;return e.jsxs("div",{className:"border-b border-gray-200 py-4",children:[e.jsxs("button",{onClick:()=>Y(s),className:"flex items-center justify-between w-full text-left",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[t,"年"]}),e.jsx("svg",{className:`h-5 w-5 text-gray-500 transform transition-transform ${l?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),l&&e.jsx("div",{className:"mt-4 space-y-6",children:Object.keys(c[s]).sort((o,a)=>parseInt(a)-parseInt(o)).map(o=>{const a=parseInt(o),x=`${s}-${a}`,b=E[x]??!0;return e.jsxs("div",{className:"ml-4",children:[e.jsxs("button",{onClick:()=>O(x),className:"flex items-center text-left",children:[e.jsx("h4",{className:"font-medium text-gray-700",children:S(a)}),e.jsx("svg",{className:`h-4 w-4 text-gray-500 ml-1 transform transition-transform ${b?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),b&&e.jsx("div",{className:"mt-3 space-y-3 ml-4",children:c[s][a].sort((r,n)=>new Date(n.timestamp).getTime()-new Date(r.timestamp).getTime()).map(r=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:w===r.id?e.jsxs("div",{children:[e.jsx("input",{type:"text",value:i.title,onChange:n=>d({...i,title:n.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 mb-2"}),e.jsx("textarea",{value:i.description,onChange:n=>d({...i,description:n.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 mb-3",rows:2}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:g,className:"px-3 py-1 text-sm text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"取消"}),e.jsx("button",{onClick:D,className:"px-3 py-1 text-sm text-white bg-blue-600 rounded-md hover:bg-blue-700",children:"保存"})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-medium text-gray-900 flex-1",children:r.title}),e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:G(r.timestamp)})]}),r.description&&e.jsx("p",{className:"text-sm text-gray-500 mb-3 leading-relaxed",children:r.description}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:Object.entries(r.expGains).filter(([n,u])=>u>0).map(([n,u])=>{const h=j[n]||{name:$(n),icon:"question",color:"#999"};return e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:`${h.color}15`,color:h.color},children:[e.jsx("div",{className:`icon-${h.icon} text-xs`}),e.jsxs("span",{children:["+",u]})]},n)})}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>L(r),className:"px-3 py-1 text-sm text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"编辑"}),e.jsx("button",{onClick:()=>y(r.id),className:"px-3 py-1 text-sm text-white bg-red-600 rounded-md hover:bg-red-700",children:"删除"})]})]})},r.id))})]},x)})})]},t)})})]})}export{B as default};
